function out = viscosity(T_in,varargin)
%% Viscosity
% Determines either the kinematic (default) or dynamic viscosity of water
% for a given temperature from 0 to 300 degC
%%
T = [0.0100000000000000,10,20,25,30,40,50,60,70,80,90,100,110,120,140,160,180,200,220,240,260,280,300,320,340,360];
mu = [0.00179140000000000,0.00130600000000000,0.00100160000000000,0.000890000000000000,0.000797200000000000,0.000652700000000000,0.000546500000000000,0.000466000000000000,0.000403500000000000,0.000354000000000000,0.000314200000000000,0.000281600000000000,0.000254600000000000,0.000232000000000000,0.000196600000000000,0.000170400000000000,0.000150400000000000,0.000134600000000000,0.000121800000000000,0.000111100000000000,0.000101800000000000,9.36000000000000e-05,8.59000000000000e-05,7.83000000000000e-05,7.03000000000000e-05,6.03000000000000e-05];
nu = 1e-6*[1.79180000000000,1.30650000000000,1.00350000000000,0.892700000000000,0.800700000000000,0.657900000000000,0.553100000000000,0.474000000000000,0.412700000000000,0.364300000000000,0.325500000000000,0.293800000000000,0.267700000000000,0.246000000000000,0.212300000000000,0.187800000000000,0.169500000000000,0.155600000000000,0.144900000000000,0.136500000000000,0.129900000000000,0.124700000000000,0.120600000000000,0.117400000000000,0.115200000000000,0.114300000000000];


if nargin>1
    type = varargin{1};
else
    type = 'nu';
end

if T_in<T(1)
    T_in = T(1); 
end

for i=1:length(T)
    idx(i) = find(T>=T_in(i),1,'first');
end


switch type
    case {'nu','kinematic'}
        out = nu(idx);
    case {'mu','dynamic'}
        out = mu(idx);
end

end

